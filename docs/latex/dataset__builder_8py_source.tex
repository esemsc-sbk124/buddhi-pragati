\doxysection{dataset\+\_\+builder.\+py}
\hypertarget{dataset__builder_8py_source}{}\label{dataset__builder_8py_source}\index{buddhi\_pragati/data/dataset\_builder.py@{buddhi\_pragati/data/dataset\_builder.py}}
\mbox{\hyperlink{dataset__builder_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00001}\mbox{\hyperlink{namespacebuddhi__pragati_1_1data_1_1dataset__builder}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00002}00002\ \textcolor{stringliteral}{Comprehensive\ Dataset\ Builder\ for\ Buddhi-\/Pragati\ Crossword\ System}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00003}00003\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00004}00004\ \textcolor{stringliteral}{This\ module\ implements\ a\ complete\ pipeline\ for\ creating\ structured\ crossword\ clue-\/answer}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00005}00005\ \textcolor{stringliteral}{datasets\ from\ multiple\ Indian\ language\ sources\ including\ MILU,\ bhasha-\/wiki,\ IndicWikiBio,}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00006}00006\ \textcolor{stringliteral}{and\ IndoWordNet.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00007}00007\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00008}00008\ \textcolor{stringliteral}{Key\ Features:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00009}00009\ \textcolor{stringliteral}{-\/\ Multi-\/source\ data\ integration\ with\ fallback\ for\ unsupported\ languages}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00010}00010\ \textcolor{stringliteral}{-\/\ Batch\ processing\ for\ memory\ efficiency}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00011}00011\ \textcolor{stringliteral}{-\/\ Quality\ control\ and\ single-\/word\ answer\ enforcement}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00012}00012\ \textcolor{stringliteral}{-\/\ HuggingFace\ dataset\ upload\ capability}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00013}00013\ \textcolor{stringliteral}{-\/\ Progress\ tracking\ and\ resumable\ processing}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00014}00014\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00015}00015\ \textcolor{stringliteral}{Architecture:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00016}00016\ \textcolor{stringliteral}{-\/\ DatasetBuilder:\ Main\ orchestrator\ class}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00017}00017\ \textcolor{stringliteral}{-\/\ SourceProcessor:\ Abstract\ base\ for\ source-\/specific\ processors}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00018}00018\ \textcolor{stringliteral}{-\/\ Language-\/aware\ processing\ with\ automatic\ source\ selection}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00019}00019\ \textcolor{stringliteral}{-\/\ Configurable\ parameters\ from\ crossword\_config.txt}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00020}00020\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00022}00022\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00023}00023\ \textcolor{keyword}{import}\ logging}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00024}00024\ \textcolor{keyword}{import}\ gc}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00025}00025\ \textcolor{keyword}{import}\ time}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00026}00026\ \textcolor{keyword}{import}\ psutil}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00027}00027\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ List,\ Dict,\ Optional,\ Tuple,\ Set}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00028}00028\ \textcolor{keyword}{from}\ collections\ \textcolor{keyword}{import}\ defaultdict}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00029}00029\ \textcolor{keyword}{from}\ dataclasses\ \textcolor{keyword}{import}\ asdict}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00030}00030\ \textcolor{keyword}{from}\ abc\ \textcolor{keyword}{import}\ ABC,\ abstractmethod}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00031}00031\ \textcolor{keyword}{import}\ pandas\ \textcolor{keyword}{as}\ pd}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00032}00032\ \textcolor{keyword}{from}\ datasets\ \textcolor{keyword}{import}\ Dataset,\ load\_dataset}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00033}00033\ \textcolor{keyword}{from}\ huggingface\_hub\ \textcolor{keyword}{import}\ HfApi,\ login}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00035}00035\ \textcolor{keyword}{from}\ ..utils.config\_loader\ \textcolor{keyword}{import}\ get\_config}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00036}00036\ \textcolor{keyword}{from}\ ..utils\ \textcolor{keyword}{import}\ is\_alphabetic\_unicode}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00037}00037\ \textcolor{keyword}{from}\ ..utils.indian\_context\_scorer\ \textcolor{keyword}{import}\ IndianContextScorer}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00038}00038\ \textcolor{keyword}{from}\ .local\_backup\_manager\ \textcolor{keyword}{import}\ LocalBackupManager}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00039}00039\ \textcolor{keyword}{from}\ .data\_structure\ \textcolor{keyword}{import}\ DatasetEntry}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00041}\mbox{\hyperlink{namespacebuddhi__pragati_1_1data_1_1dataset__builder_a7b003a6c67eecc5162848cccdaf235f7}{00041}}\ logger\ =\ logging.getLogger(\_\_name\_\_)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00044}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor}{00044}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor}{SourceProcessor}}(ABC):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00045}00045\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ Abstract\ base\ class\ for\ source-\/specific\ data\ processors.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00047}00047\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ Each\ source\ (MILU,\ bhasha-\/wiki,\ etc.)\ implements\ this\ interface\ to\ provide}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ consistent\ processing\ of\ raw\ data\ into\ standardized\ DatasetEntry\ objects.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00052}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ac0bab857d8cb68dacbd504f5256964a4}{00052}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ac0bab857d8cb68dacbd504f5256964a4}{\_\_init\_\_}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ config:\ dict,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ language:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ context\_scorer:\ Optional[IndianContextScorer]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00057}00057\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00058}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a75dcd20b1d117f788e863d080f72d509}{00058}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a75dcd20b1d117f788e863d080f72d509}{config}}\ =\ config}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00059}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ac4290114a955e590ae0361b9e59a35d6}{00059}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ac4290114a955e590ae0361b9e59a35d6}{language}}\ =\ language}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00060}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a153bcbb510048f3b79bb4af3a6a765ad}{00060}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a153bcbb510048f3b79bb4af3a6a765ad}{processed\_count}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00061}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_aa5029592af0e379a5708ea1c5f72ea98}{00061}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_aa5029592af0e379a5708ea1c5f72ea98}{valid\_count}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Rejection\ tracking}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00064}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a8a4714876f672982d52ddd4bea3fe0a8}{00064}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a8a4714876f672982d52ddd4bea3fe0a8}{answer\_in\_clue\_rejections}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00065}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a5abd68487b9ca52ee5eeef203a75cb64}{00065}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a5abd68487b9ca52ee5eeef203a75cb64}{other\_rejections}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Enhanced\ context\ scoring}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00068}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{00068}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{\_context\_scorer}}\ =\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ context\_scorer\ \ \textcolor{comment}{\#\ Use\ provided\ scorer\ first,\ fallback\ to\ lazy-\/loading}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00071}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a631dc0711391faa70d3a361e06f8949a}{00071}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a631dc0711391faa70d3a361e06f8949a}{\_enable\_enhanced\_scoring}}\ =\ config.get(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ENABLE\_TIERED\_CONTEXT\_SCORING"{}},\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00075}00075\ \ \ \ \ \textcolor{preprocessor}{@abstractmethod}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00076}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ad7ae21c80ff0ad7a1e4709746710de5b}{00076}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ad7ae21c80ff0ad7a1e4709746710de5b}{get\_supported\_languages}}(self)\ -\/>\ Set[str]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ set\ of\ languages\ supported\ by\ this\ source."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00080}00080\ \ \ \ \ \textcolor{preprocessor}{@abstractmethod}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00081}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a3da768df8b6ff82fa1e593cca13205f0}{00081}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a3da768df8b6ff82fa1e593cca13205f0}{process\_batch}}(self,\ batch\_data:\ List[Dict])\ -\/>\ List[DatasetEntry]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Process\ a\ batch\ of\ raw\ data\ into\ standardized\ entries."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00085}00085\ \ \ \ \ \textcolor{preprocessor}{@abstractmethod}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00086}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ab7267908c99eb1dc87c5f0d353369170}{00086}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ab7267908c99eb1dc87c5f0d353369170}{load\_raw\_data}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ self,\ batch\_size:\ int,\ offset:\ int\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00088}00088\ \ \ \ \ )\ -\/>\ Tuple[List[Dict],\ bool]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Load\ raw\ data\ batch\ from\ source.\ Returns\ (data,\ has\_more)."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00092}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_af03b8665b2792624865afa666650d0c5}{00092}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_af03b8665b2792624865afa666650d0c5}{is\_single\_word}}(self,\ text:\ str)\ -\/>\ bool:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ if\ text\ is\ a\ single\ word\ suitable\ for\ crossword."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ text\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ text.strip():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ words\ =\ text.strip().split()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ len(words)\ ==\ 1\ \textcolor{keywordflow}{and}\ is\_alphabetic\_unicode(words[0])}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00099}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a8b98224c38829de3056ada28760a0126}{00099}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a8b98224c38829de3056ada28760a0126}{calculate\_quality\_score}}(self,\ clue:\ str,\ answer:\ str)\ -\/>\ float:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Calculate\ crossword\ suitability\ score."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ score\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Penalize\ very\ short\ or\ very\ long\ clues}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ clue\_len\ =\ len(clue)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ clue\_len\ <\ 10:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ score\ *=\ 0.5}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ clue\_len\ >\ 200:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ score\ *=\ 0.7}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reward\ medium-\/length\ answers\ (5-\/8\ chars\ are\ ideal\ for\ crosswords)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ answer\_len\ =\ len(answer)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 5\ <=\ answer\_len\ <=\ 8:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ score\ *=\ 1.2}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ answer\_len\ <\ 3\ \textcolor{keywordflow}{or}\ answer\_len\ >\ 12:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ score\ *=\ 0.6}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Penalize\ answers\ with\ repeated\ characters}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ unique\_chars\ =\ len(set(answer))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ unique\_chars\ /\ len(answer)\ <\ 0.5:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ score\ *=\ 0.8}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ min(score,\ 1.0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00124}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ab0add796c2b9cabdebcb762907641f70}{00124}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_ab0add796c2b9cabdebcb762907641f70}{\_load\_context\_scorer}}(self)\ -\/>\ Optional[IndianContextScorer]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Lazy\ load\ the\ Indian\ context\ scorer\ with\ proper\ configuration\ parsing."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{\_context\_scorer}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a631dc0711391faa70d3a361e06f8949a}{\_enable\_enhanced\_scoring}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ scoring\ weights\ from\ config}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parsed\_config\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a6db0db9696d5bf3ce5ccabd721204dfb}{\_parse\_scoring\_config}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ mode\ from\ parent\ DatasetBuilder\ if\ available}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mode\ =\ getattr(self,\ \textcolor{stringliteral}{"{}context\_scoring\_mode"{}},\ \textcolor{stringliteral}{"{}complete"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{\_context\_scorer}}\ =\ \mbox{\hyperlink{classbuddhi__pragati_1_1utils_1_1indian__context__scorer_1_1IndianContextScorer}{IndianContextScorer}}(parsed\_config,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Loaded\ IndianContextScorer\ for\ language:\ \{self.language\}\ (mode:\ \{mode\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Failed\ to\ load\ IndianContextScorer:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{\_context\_scorer}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_adf852d8b32f6feb8f9254b36ace2ea95}{\_context\_scorer}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00142}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a6db0db9696d5bf3ce5ccabd721204dfb}{00142}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a6db0db9696d5bf3ce5ccabd721204dfb}{\_parse\_scoring\_config}}(self)\ -\/>\ Dict[str,\ any]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Parse\ scoring\ configuration\ from\ string\ format\ to\ proper\ types."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ config\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1SourceProcessor_a75dcd20b1d117f788e863d080f72d509}{config}}.copy()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ tier\ 1\ weights\ (embedding,keyword)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}\ \textcolor{keywordflow}{in}\ config:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ weights\_str\ =\ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(weights\_str,\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\ =\ [float(x.strip())\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ weights\_str.split(\textcolor{stringliteral}{"{},"{}})]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(weights)\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}]\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}embedding"{}}:\ weights[0],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}keyword"{}}:\ weights[1],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ tier\ 2\ weights\ (multilingual,indic,keyword)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}\ \textcolor{keywordflow}{in}\ config:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ weights\_str\ =\ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(weights\_str,\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\ =\ [float(x.strip())\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ weights\_str.split(\textcolor{stringliteral}{"{},"{}})]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(weights)\ ==\ 3:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}]\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}multilingual"{}}:\ weights[0],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}indic"{}}:\ weights[1],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}keyword"{}}:\ weights[2],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ config}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00172}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder}{00172}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder}{DatasetBuilder}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00173}00173\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ Main\ orchestrator\ for\ building\ structured\ crossword\ datasets.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00175}00175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ Coordinates\ multiple\ source\ processors\ to\ create\ a\ unified\ dataset}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ with\ configurable\ size\ and\ quality\ controls.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00180}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_adbaf5461f57b0148cd55ffffe4bb2ff0}{00180}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_adbaf5461f57b0148cd55ffffe4bb2ff0}{\_\_init\_\_}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ hf\_token:\ Optional[str]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ context\_scoring\_mode:\ str\ =\ \textcolor{stringliteral}{"{}complete"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ custom\_batch\_size:\ Optional[int]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00185}00185\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ .source\_processors\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ MILUProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ BhashaWikiProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ IndicWikiBioProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ IndoWordNetProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00192}00192\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00193}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a792ff43ce31f5612452eec06c254c1e2}{00193}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a792ff43ce31f5612452eec06c254c1e2}{config}}\ =\ get\_config()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00194}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{00194}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a792ff43ce31f5612452eec06c254c1e2}{config}}.get\_dataset\_config()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00195}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{00195}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}}\ =\ hf\_token\ \textcolor{keywordflow}{or}\ os.getenv(\textcolor{stringliteral}{"{}HF\_TOKEN"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00196}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a5754576846c0d1d0305f6b45902b78c1}{00196}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a5754576846c0d1d0305f6b45902b78c1}{context\_scoring\_mode}}\ =\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ context\_scoring\_mode\ \ \textcolor{comment}{\#\ Store\ mode\ for\ context\ scoring}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00199}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a22933f6cf034f7aa69d8bf9c13b7fbb9}{00199}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a22933f6cf034f7aa69d8bf9c13b7fbb9}{custom\_batch\_size}}\ =\ custom\_batch\_size\ \ \textcolor{comment}{\#\ CLI\ override\ for\ batch\ size}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00200}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{00200}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}\ =\ defaultdict(\textcolor{keyword}{lambda}:\ defaultdict(int))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Memory\ tracking}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00203}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a2c30f9b478d87d2df4bc3faacb1510b3}{00203}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a2c30f9b478d87d2df4bc3faacb1510b3}{initial\_memory}}\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7421a55818207ad9b52df55bf0d6d251}{\_get\_memory\_usage}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Shared\ context\ scorers\ to\ avoid\ repeated\ model\ loading}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00206}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{00206}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}\ =\ \{\}\ \ \textcolor{comment}{\#\ language\ -\/>\ IndianContextScorer\ instance}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Mapping\ of\ source\ names\ to\ their\ processor\ classes}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00209}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ace7bb0522415787a2f4c753a17d876dc}{00209}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ace7bb0522415787a2f4c753a17d876dc}{SOURCE\_PROCESSORS}}\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}MILU"{}}:\ MILUProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Bhasha-\/Wiki"{}}:\ BhashaWikiProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}IndicWikiBio"{}}:\ IndicWikiBioProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}IndoWordNet"{}}:\ IndoWordNetProcessor,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initialize\ HF\ API\ if\ token\ provided}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ login(token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00219}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a6b163206709d70cc38b1debc6c882d1d}{00219}}\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a6b163206709d70cc38b1debc6c882d1d}{hf\_api}}\ =\ HfApi()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a6b163206709d70cc38b1debc6c882d1d}{hf\_api}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00223}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7421a55818207ad9b52df55bf0d6d251}{00223}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7421a55818207ad9b52df55bf0d6d251}{\_get\_memory\_usage}}(self)\ -\/>\ Dict[str,\ float]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Get\ current\ memory\ usage\ statistics."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ process\ =\ psutil.Process()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ memory\_info\ =\ process.memory\_info()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}rss\_mb"{}}:\ memory\_info.rss\ /\ 1024\ /\ 1024,\ \ \textcolor{comment}{\#\ Resident\ Set\ Size\ in\ MB}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}vms\_mb"{}}:\ memory\_info.vms\ /\ 1024\ /\ 1024,\ \ \textcolor{comment}{\#\ Virtual\ Memory\ Size\ in\ MB}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}percent"{}}:\ process.memory\_percent(),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Failed\ to\ get\ memory\ usage:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\textcolor{stringliteral}{"{}rss\_mb"{}}:\ 0,\ \textcolor{stringliteral}{"{}vms\_mb"{}}:\ 0,\ \textcolor{stringliteral}{"{}percent"{}}:\ 0\}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00237}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a30400cbd694b580ac5ec0ec8bf7d8a92}{00237}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a30400cbd694b580ac5ec0ec8bf7d8a92}{\_log\_memory\_usage}}(self,\ context:\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Log\ current\ memory\ usage\ with\ context."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ current\_memory\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7421a55818207ad9b52df55bf0d6d251}{\_get\_memory\_usage}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ memory\_change\ =\ current\_memory[\textcolor{stringliteral}{"{}rss\_mb"{}}]\ -\/\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a2c30f9b478d87d2df4bc3faacb1510b3}{initial\_memory}}[\textcolor{stringliteral}{"{}rss\_mb"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}MEMORY\_USAGE\ (\{context\}):\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}RSS=\{current\_memory['rss\_mb']:.1f\}MB\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}(+\{memory\_change:+.1f\}MB),\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}VMS=\{current\_memory['vms\_mb']:.1f\}MB,\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Percent=\{current\_memory['percent']:.1f\}\%"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ current\_memory}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00252}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a173a12e99fa94790040b909289e5a40d}{00252}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a173a12e99fa94790040b909289e5a40d}{\_get\_shared\_context\_scorer}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ self,\ language:\ str}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00254}00254\ \ \ \ \ )\ -\/>\ Optional[IndianContextScorer]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ or\ create\ shared\ IndianContextScorer\ for\ a\ language.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00257}00257\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ method\ ensures\ that\ sentence\ transformer\ models\ are\ loaded\ only\ once\ per\ language,}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ rather\ than\ once\ per\ source\ processor,\ significantly\ reducing\ model\ loading\ overhead.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00260}00260\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ language:\ Target\ language\ for\ context\ scoring}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00263}00263\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Shared\ IndianContextScorer\ instance\ for\ the\ language,\ or\ None\ if\ scorer\ disabled/failed}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ enhanced\ scoring\ is\ enabled}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(\textcolor{stringliteral}{"{}ENABLE\_TIERED\_CONTEXT\_SCORING"{}},\ \textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00270}00270\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Return\ existing\ scorer\ if\ already\ created}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ language\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}[language]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00274}00274\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ scoring\ configuration\ (replicating\ SourceProcessor.\_parse\_scoring\_config\ logic)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ config\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.copy()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ tier\ 1\ weights\ (embedding,ner,keyword)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}\ \textcolor{keywordflow}{in}\ config:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\_str\ =\ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(weights\_str,\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\ =\ [float(x.strip())\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ weights\_str.split(\textcolor{stringliteral}{"{},"{}})]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(weights)\ ==\ 3:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER1"{}}]\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}embedding"{}}:\ weights[0],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ner"{}}:\ weights[1],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}keyword"{}}:\ weights[2],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Parse\ tier\ 2\ weights\ (multilingual,indic,ner,keyword)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}\ \textcolor{keywordflow}{in}\ config:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\_str\ =\ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(weights\_str,\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights\ =\ [float(x.strip())\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ weights\_str.split(\textcolor{stringliteral}{"{},"{}})]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(weights)\ ==\ 4:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config[\textcolor{stringliteral}{"{}CONTEXT\_SCORING\_WEIGHTS\_TIER2"{}}]\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}multilingual"{}}:\ weights[0],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}indic"{}}:\ weights[1],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ner"{}}:\ weights[2],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}keyword"{}}:\ weights[3],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00303}00303\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ and\ cache\ the\ scorer\ with\ mode}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Creating\ shared\ IndianContextScorer\ for\ language:\ \{language\}\ (mode:\ \{self.context\_scoring\_mode\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ scorer\ =\ \mbox{\hyperlink{classbuddhi__pragati_1_1utils_1_1indian__context__scorer_1_1IndianContextScorer}{IndianContextScorer}}(config,\ mode=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a5754576846c0d1d0305f6b45902b78c1}{context\_scoring\_mode}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}[language]\ =\ scorer}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Successfully\ created\ shared\ IndianContextScorer\ for\ language:\ \{language\}\ (mode:\ \{self.context\_scoring\_mode\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ scorer}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00315}00315\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00316}00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Failed\ to\ create\ shared\ IndianContextScorer\ for\ \{language\}:\ \{e\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}[language]\ =\ \textcolor{keywordtype}{None}\ \ \textcolor{comment}{\#\ Cache\ the\ failure}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00323}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ad919354d3558340395dbbb1143a420f0}{00323}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ad919354d3558340395dbbb1143a420f0}{\_cleanup\_shared\_scorers}}(self):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Clean\ up\ shared\ context\ scorers\ to\ free\ memory."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Cleaning\ up\ \{len(self.shared\_context\_scorers)\}\ shared\ context\ scorers"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a45f7f070e7d794682b950c7729f87703}{shared\_context\_scorers}}.clear()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ gc.collect()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00332}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_af48ac3fc1427774f6c12ef2305b60d30}{00332}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_af48ac3fc1427774f6c12ef2305b60d30}{\_cleanup\_after\_upload}}(self):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Comprehensive\ cleanup\ after\ upload\ to\ free\ memory."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Performing\ post-\/upload\ memory\ cleanup"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clean\ up\ shared\ context\ scorers}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ad919354d3558340395dbbb1143a420f0}{\_cleanup\_shared\_scorers}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00338}00338\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clear\ processing\ statistics\ to\ free\ memory}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}.clear()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00341}00341\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Force\ garbage\ collection}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ gc.collect()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00344}00344\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Log\ memory\ usage\ after\ cleanup}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a30400cbd694b580ac5ec0ec8bf7d8a92}{\_log\_memory\_usage}}(\textcolor{stringliteral}{"{}POST\_UPLOAD\_CLEANUP"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00347}00347\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Post-\/upload\ memory\ cleanup\ complete"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00350}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ac9d26f9811e7a14dba6abe2ea5b9e8ca}{00350}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ac9d26f9811e7a14dba6abe2ea5b9e8ca}{\_compute\_deferred\_context\_scores}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ self,\ entries:\ List[DatasetEntry],\ language:\ str}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00352}00352\ \ \ \ \ )\ -\/>\ List[DatasetEntry]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ context\ scores\ for\ entries\ that\ have\ passed\ quality\ filtering.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00355}00355\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ method\ implements\ deferred\ context\ scoring\ to\ avoid\ expensive\ ML\ model}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ computations\ for\ entries\ that\ will\ be\ filtered\ out\ due\ to\ low\ quality\ scores.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00358}00358\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ entries:\ List\ of\ dataset\ entries\ that\ have\ passed\ quality\ filtering}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ language:\ Target\ language\ for\ context\ scoring}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00362}00362\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00363}00363\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ List\ of\ entries\ with\ updated\ context\ scores}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00365}00365\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ entries:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ entries}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00368}00368\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ shared\ context\ scorer\ for\ this\ language}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ shared\_scorer\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a173a12e99fa94790040b909289e5a40d}{\_get\_shared\_context\_scorer}}(language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ shared\_scorer:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00373}00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}No\ context\ scorer\ available\ for\ \{language\},\ keeping\ default\ context\ scores"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00374}00374\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ entries}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00376}00376\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Computing\ deferred\ context\ scores\ for\ \{len(entries)\}\ entries\ in\ \{language\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00379}00379\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00380}00380\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00381}00381\ \ \ \ \ \ \ \ \ updated\_entries\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00382}00382\ \ \ \ \ \ \ \ \ successful\_scores\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ failed\_scores\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ entry\ \textcolor{keywordflow}{in}\ enumerate(entries):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00386}00386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00387}00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ context\ score\ using\ the\ shared\ scorer}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00388}00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ shared\_scorer.score\_context(entry.clue,\ entry.answer,\ language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00389}00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context\_score\ =\ result.get(\textcolor{stringliteral}{"{}final\_score"{}},\ 0.0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00390}00390\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00391}00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ensure\ valid\ range\ and\ update\ entry}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00392}00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context\_score\ =\ max(0.0,\ min(1.0,\ context\_score))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00393}00393\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ updated\ entry\ with\ computed\ context\ score}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00395}00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ updated\_entry\ =\ \mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1data__structure_1_1DatasetEntry}{DatasetEntry}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ id=entry.id,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ clue=entry.clue,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00398}00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer=entry.answer,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source=entry.source,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00400}00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_id=entry.source\_id,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context\_score=context\_score,\ \ \textcolor{comment}{\#\ Updated\ with\ computed\ score}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ quality\_score=entry.quality\_score,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ updated\_entries.append(updated\_entry)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ successful\_scores\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Log\ progress\ for\ large\ batches}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ 1)\ \%\ 50\ ==\ 0\ \textcolor{keywordflow}{or}\ i\ ==\ len(entries)\ -\/\ 1:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Computed\ context\ scores:\ \{i\ +\ 1\}/\{len(entries)\}\ entries\ processed"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00412}00412\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Failed\ to\ compute\ context\ score\ for\ entry\ \{entry.id\}:\ \{e\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Keep\ original\ entry\ with\ default\ context\ score\ (0.0)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ updated\_entries.append(entry)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ failed\_scores\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00420}00420\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Log\ final\ statistics}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Deferred\ context\ scoring\ complete:\ \{successful\_scores\}\ successful,\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{failed\_scores\}\ failed,\ \{len(updated\_entries)\}\ total\ entries"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00426}00426\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ updated\_entries}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00428}00428\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00429}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9a16b02d16167ec2161067e672805750}{00429}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9a16b02d16167ec2161067e672805750}{get\_available\_sources\_for\_language}}(self,\ language:\ str)\ -\/>\ List[str]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Get\ list\ of\ sources\ that\ support\ the\ given\ language."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ available\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ source\_name,\ processor\_class\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ace7bb0522415787a2f4c753a17d876dc}{SOURCE\_PROCESSORS}}.items():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ temporary\ instance\ to\ check\ language\ support}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ \ \ \ \ temp\_processor\ =\ processor\_class(self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}},\ language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ language\ \textcolor{keywordflow}{in}\ temp\_processor.get\_supported\_languages():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ available.append(source\_name)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ available}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00439}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ab9508ba923e1f2a6d444fefeb4b77688}{00439}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ab9508ba923e1f2a6d444fefeb4b77688}{calculate\_source\_batch\_size}}(self,\ source\_name:\ str,\ target\_size:\ int)\ -\/>\ int:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Calculate\ optimal\ batch\ size\ for\ a\ specific\ source\ based\ on\ source\ characteristics\ and\ target\ size.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00442}00442\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00444}00444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ source\_name:\ Name\ of\ the\ data\ source\ (MILU,\ IndicWikiBio,\ IndoWordNet,\ Bhasha-\/Wiki)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ target\_size:\ Target\ number\ of\ entries\ for\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00446}00446\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00448}00448\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Optimal\ batch\ size\ for\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Use\ CLI\ override\ if\ provided}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00451}00451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a22933f6cf034f7aa69d8bf9c13b7fbb9}{custom\_batch\_size}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00452}00452\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00453}00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Using\ CLI\ batch\ size\ override:\ \{self.custom\_batch\_size\}\ for\ \{source\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00455}00455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a22933f6cf034f7aa69d8bf9c13b7fbb9}{custom\_batch\_size}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00456}00456\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00457}00457\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Source-\/specific\ batch\ size\ calculation\ based\ on\ efficiency\ and\ constraints}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00458}00458\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ source\_name\ ==\ \textcolor{stringliteral}{"{}MILU"{}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00459}00459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ MILU:\ 1.5x\ target\ size\ (good\ efficiency,\ can\ handle\ larger\ batches)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ int(1.5\ *\ target\_size)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00461}00461\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ source\_name\ ==\ \textcolor{stringliteral}{"{}IndicWikiBio"{}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00462}00462\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ IndicWikiBio:\ 0.5x\ target\ size\ (moderate\ efficiency,\ medium\ batches)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00463}00463\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ int(0.5\ *\ target\_size)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00464}00464\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ source\_name\ ==\ \textcolor{stringliteral}{"{}IndoWordNet"{}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00465}00465\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ IndoWordNet:\ 0.25x\ target\ size\ (lower\ efficiency,\ smaller\ batches)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00466}00466\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ int(0.25\ *\ target\_size)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ source\_name\ ==\ \textcolor{stringliteral}{"{}Bhasha-\/Wiki"{}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Bhasha-\/Wiki:\ 5x\ target\ size\ (very\ low\ efficiency,\ large\ batches\ needed)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ int(5\ *\ target\_size)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00470}00470\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Fallback\ to\ config\ default\ for\ unknown\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(\textcolor{stringliteral}{"{}BATCH\_SIZE\_PROCESSING"{}},\ 100)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00473}00473\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Unknown\ source\ \{source\_name\},\ using\ default\ batch\ size:\ \{batch\_size\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00476}00476\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ensure\ minimum\ batch\ size\ of\ 1}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ batch\_size\ =\ max(1,\ batch\_size)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00479}00479\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Calculated\ batch\ size\ for\ \{source\_name\}:\ \{batch\_size\}\ (target:\ \{target\_size\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00483}00483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ batch\_size}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00484}00484\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00485}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a8e193eef65eda5f71b5a7ec6e199fd92}{00485}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a8e193eef65eda5f71b5a7ec6e199fd92}{calculate\_target\_per\_source}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00487}00487\ \ \ \ \ \ \ \ \ language:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00488}00488\ \ \ \ \ \ \ \ \ total\_target:\ int,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00489}00489\ \ \ \ \ \ \ \ \ requested\_sources:\ List[str]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00490}00490\ \ \ \ \ )\ -\/>\ Dict[str,\ int]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00491}00491\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Calculate\ how\ many\ entries\ to\ generate\ per\ source\ for\ uniform\ distribution."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00492}00492\ \ \ \ \ \ \ \ \ available\_sources\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9a16b02d16167ec2161067e672805750}{get\_available\_sources\_for\_language}}(language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00493}00493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ available\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00494}00494\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(f\textcolor{stringliteral}{"{}No\ sources\ available\ for\ language:\ \{language\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00495}00495\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00496}00496\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Filter\ by\ requested\ sources\ if\ specified}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00497}00497\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ requested\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00498}00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Only\ keep\ sources\ that\ are\ both\ available\ and\ requested}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00499}00499\ \ \ \ \ \ \ \ \ \ \ \ \ filtered\_sources\ =\ [s\ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ requested\_sources\ \textcolor{keywordflow}{if}\ s\ \textcolor{keywordflow}{in}\ available\_sources]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ filtered\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}None\ of\ the\ requested\ sources\ \{requested\_sources\}\ are\ available\ for\ language:\ \{language\}.\ Available\ sources:\ \{available\_sources\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00503}00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00504}00504\ \ \ \ \ \ \ \ \ \ \ \ \ available\_sources\ =\ filtered\_sources}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00505}00505\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00506}00506\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Using\ sources\ for\ \{language\}:\ \{available\_sources\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00507}00507\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00508}00508\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Distribute\ target\ evenly\ across\ available\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ per\_source\ =\ total\_target\ //\ len(available\_sources)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ remainder\ =\ total\_target\ \%\ len(available\_sources)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00511}00511\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ targets\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00513}00513\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ source\ \textcolor{keywordflow}{in}\ enumerate(available\_sources):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00514}00514\ \ \ \ \ \ \ \ \ \ \ \ \ targets[source]\ =\ per\_source\ +\ (1\ \textcolor{keywordflow}{if}\ i\ <\ remainder\ \textcolor{keywordflow}{else}\ 0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00515}00515\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00516}00516\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Target\ distribution\ for\ \{language\}:\ \{targets\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00517}00517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ targets}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00518}00518\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00519}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_aa0c11755ee778e687fc67acb60db3cfa}{00519}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_aa0c11755ee778e687fc67acb60db3cfa}{process\_source\_streaming}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ source\_name:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00522}00522\ \ \ \ \ \ \ \ \ language:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00523}00523\ \ \ \ \ \ \ \ \ target\_count:\ int,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00524}00524\ \ \ \ \ \ \ \ \ start\_offset:\ int\ =\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00525}00525\ \ \ \ \ \ \ \ \ backup\_manager=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00526}00526\ \ \ \ \ )\ -\/>\ Tuple[int,\ object]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Process\ a\ single\ source\ and\ accumulate\ entries\ to\ disk\ via\ backup\ manager.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00528}00528\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00529}00529\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ source\_name:\ Name\ of\ the\ data\ source\ to\ process}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00531}00531\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ language:\ Target\ language}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ target\_count:\ Number\ of\ entries\ to\ process}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ start\_offset:\ Starting\ offset\ for\ processing}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ backup\_manager:\ LocalBackupManager\ instance\ for\ saving\ batches\ to\ disk}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00535}00535\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00536}00536\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00537}00537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Tuple[int,\ LocalBackupManager]:\ (total\ entries\ saved,\ backup\ manager\ instance)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Processing\ \{source\_name\}\ for\ \{language\},\ target:\ \{target\_count\},\ starting\ from\ offset:\ \{start\_offset\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}Mode:\ ACCUMULATION"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00544}00544\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Log\ initial\ memory\ usage\ for\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00545}00545\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a30400cbd694b580ac5ec0ec8bf7d8a92}{\_log\_memory\_usage}}(f\textcolor{stringliteral}{"{}START\ \{source\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00546}00546\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00547}00547\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ source\_name\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ace7bb0522415787a2f4c753a17d876dc}{SOURCE\_PROCESSORS}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00548}00548\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(f\textcolor{stringliteral}{"{}Unknown\ source:\ \{source\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00549}00549\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00550}00550\ \ \ \ \ \ \ \ \ processor\_class\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ace7bb0522415787a2f4c753a17d876dc}{SOURCE\_PROCESSORS}}[source\_name]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00551}00551\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00552}00552\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ shared\ context\ scorer\ for\ this\ language\ to\ avoid\ repeated\ model\ loading}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ shared\_scorer\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a173a12e99fa94790040b909289e5a40d}{\_get\_shared\_context\_scorer}}(language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00554}00554\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00555}00555\ \ \ \ \ \ \ \ \ processor\ =\ processor\_class(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00556}00556\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}},\ language,\ context\_scorer=shared\_scorer}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00557}00557\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00558}00558\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ source-\/specific\ batch\ size}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ batch\_size\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ab9508ba923e1f2a6d444fefeb4b77688}{calculate\_source\_batch\_size}}(source\_name,\ target\_count)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ offset\ =\ start\_offset}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ seen\_answers\ =\ set()\ \ \textcolor{comment}{\#\ For\ deduplication}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00563}00563\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00564}00564\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Track\ processing\ for\ disk-\/based\ accumulation}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00565}00565\ \ \ \ \ \ \ \ \ total\_saved\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ starting\ batch\ number\ to\ avoid\ overwriting\ existing\ batch\ files}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00567}00567\ \ \ \ \ \ \ \ \ existing\_batches\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00568}00568\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ backup\_manager:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00569}00569\ \ \ \ \ \ \ \ \ \ \ \ \ language\_dir\ =\ backup\_manager.backup\_dir\ /\ language.lower()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00570}00570\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ language\_dir.exists():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00571}00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ existing\_batches\ =\ list(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ language\_dir.glob(f\textcolor{stringliteral}{"{}batch\_\{source\_name\}\_*.json"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00573}00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00574}00574\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00575}00575\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Start\ batch\ numbering\ after\ existing\ batches\ for\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00576}00576\ \ \ \ \ \ \ \ \ batch\_num\ =\ len(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00577}00577\ \ \ \ \ \ \ \ \ \ \ \ \ [b\ \textcolor{keywordflow}{for}\ b\ \textcolor{keywordflow}{in}\ existing\_batches\ \textcolor{keywordflow}{if}\ f\textcolor{stringliteral}{"{}batch\_\{source\_name\}\_"{}}\ \textcolor{keywordflow}{in}\ b.name]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00579}00579\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00580}00580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ total\_saved\ <\ target\_count:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00581}00581\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00582}00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Processing\ batch\ \{batch\_num\ +\ 1\}\ for\ \{source\_name\}\ (saved:\ \{total\_saved\}/\{target\_count\})..."{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00584}00584\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00585}00585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Load\ batch}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ \ \ \ \ raw\_batch,\ has\_more\ =\ processor.load\_raw\_data(batch\_size,\ offset)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ raw\_batch:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}No\ more\ data\ available\ from\ \{source\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00590}00590\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00591}00591\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ current\ offset\ for\ unique\ ID\ generation\ (especially\ for\ MILU)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00592}00592\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(processor,\ \textcolor{stringliteral}{"{}set\_current\_offset"{}}):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00593}00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ processor.set\_current\_offset(offset)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00594}00594\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00595}00595\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Process\ batch\ with\ immediate\ quality\ filtering}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00596}00596\ \ \ \ \ \ \ \ \ \ \ \ \ raw\_batch\_entries\ =\ processor.process\_batch(raw\_batch)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00597}00597\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00598}00598\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ deduplication\ and\ save\ to\ disk\ via\ backup\ manager}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00599}00599\ \ \ \ \ \ \ \ \ \ \ \ \ deduplicated\_batch\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00600}00600\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ entry\ \textcolor{keywordflow}{in}\ raw\_batch\_entries:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\_key\ =\ entry.answer.upper()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ answer\_key\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ seen\_answers:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00603}00603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seen\_answers.add(answer\_key)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ deduplicated\_batch.append(entry)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00605}00605\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ MIN\_QUALITY\_SCORE\ filtering\ before\ context\ scoring}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ \ \ \ \ min\_quality\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(\textcolor{stringliteral}{"{}MIN\_QUALITY\_SCORE"{}},\ 0.5)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \ \ \ quality\_filtered\_entries\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ e\ \textcolor{keywordflow}{for}\ e\ \textcolor{keywordflow}{in}\ deduplicated\_batch\ \textcolor{keywordflow}{if}\ e.quality\_score\ >=\ min\_quality}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00611}00611\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ deferred\ context\ scoring\ to\ this\ batch}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_start\_time\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ \ \ \ \ processed\_batch\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ac9d26f9811e7a14dba6abe2ea5b9e8ca}{\_compute\_deferred\_context\_scores}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ quality\_filtered\_entries,\ language}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_time\ =\ time.time()\ -\/\ batch\_start\_time}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00618}00618\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Context\ scored\ batch\ for\ \{source\_name\}:\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{len(processed\_batch)\}/\{len(processed\_batch)\}\ entries\ processed\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}(processing:\ \{batch\_time:.1f\}s)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00624}00624\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Save\ to\ disk\ via\ backup\ manager\ if\ provided}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ backup\_manager\ \textcolor{keywordflow}{and}\ processed\_batch:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch\_path\ =\ backup\_manager.save\_batch(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ language,\ source\_name,\ batch\_num,\ processed\_batch}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00629}00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ batch\_path:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Saved\ \{len(processed\_batch)\}\ entries\ to\ \{batch\_path\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00632}00632\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ total\_saved\ +=\ len(processed\_batch)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_num\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00635}00635\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stop\ if\ we've\ reached\ our\ target}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ total\_saved\ >=\ target\_count:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00638}00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00639}00639\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00640}00640\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ processing\ statistics}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_processed\ =\ len(raw\_batch)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_valid\ =\ len(processed\_batch)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00643}00643\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ source\_name\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00645}00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}[source\_name]\ =\ \{\textcolor{stringliteral}{"{}processed"{}}:\ 0,\ \textcolor{stringliteral}{"{}valid"{}}:\ 0\}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00646}00646\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}[source\_name][\textcolor{stringliteral}{"{}processed"{}}]\ +=\ batch\_processed}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}[source\_name][\textcolor{stringliteral}{"{}valid"{}}]\ +=\ batch\_valid}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00649}00649\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ offset\ for\ next\ iteration}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ offset\ +=\ len(raw\_batch)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00652}00652\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ we've\ reached\ the\ end\ of\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ has\_more:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Reached\ end\ of\ \{source\_name\}\ data"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00657}00657\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \ \ \ \ offset\ +=\ batch\_size}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00659}00659\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Log\ final\ memory\ usage\ for\ this\ source}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a30400cbd694b580ac5ec0ec8bf7d8a92}{\_log\_memory\_usage}}(f\textcolor{stringliteral}{"{}END\ \{source\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00662}00662\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ and\ log\ efficiency\ metrics}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ processed\_total\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}[source\_name][\textcolor{stringliteral}{"{}processed"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ valid\_total\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a88039ba12e279a3ece12a3825cef8b9c}{stats}}[source\_name][\textcolor{stringliteral}{"{}valid"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00666}00666\ \ \ \ \ \ \ \ \ efficiency\ =\ (valid\_total\ /\ processed\_total\ *\ 100)\ \textcolor{keywordflow}{if}\ processed\_total\ >\ 0\ \textcolor{keywordflow}{else}\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00668}00668\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ rejection\ statistics\ from\ processor}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00669}00669\ \ \ \ \ \ \ \ \ answer\_in\_clue\_rejections\ =\ getattr(processor,\ \textcolor{stringliteral}{"{}answer\_in\_clue\_rejections"{}},\ 0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00670}00670\ \ \ \ \ \ \ \ \ other\_rejections\ =\ getattr(processor,\ \textcolor{stringliteral}{"{}other\_rejections"{}},\ 0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00671}00671\ \ \ \ \ \ \ \ \ answer\_in\_clue\_pct\ =\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00672}00672\ \ \ \ \ \ \ \ \ \ \ \ \ (answer\_in\_clue\_rejections\ /\ processed\_total\ *\ 100)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00673}00673\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ processed\_total\ >\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00675}00675\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00676}00676\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00677}00677\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00678}00678\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Completed\ \{source\_name\}:\ \{total\_saved\}/\{target\_count\}\ entries\ saved\ to\ disk\ (\{batch\_num\}\ batches)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00679}00679\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}SOURCE\_EFFICIENCY\ \{source\_name\}:\ \{efficiency:.1f\}\%\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}(\{valid\_total\}\ valid\ /\ \{processed\_total\}\ processed)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00684}00684\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00685}00685\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}SOURCE\_REJECTIONS\ \{source\_name\}:\ answer-\/in-\/clue\ \{answer\_in\_clue\_rejections\}\ (\{answer\_in\_clue\_pct:.1f\}\%),\ "{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00686}00686\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}other\ \{other\_rejections\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00687}00687\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00688}00688\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ total\_saved,\ backup\_manager}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00690}00690\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00691}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a62d6b48f786a831480411958c0ed88b0}{00691}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a62d6b48f786a831480411958c0ed88b0}{build\_dataset}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00693}00693\ \ \ \ \ \ \ \ \ language:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ total\_target:\ int\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00695}00695\ \ \ \ \ \ \ \ \ sources:\ List[str]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00696}00696\ \ \ \ \ )\ -\/>\ LocalBackupManager:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00697}00697\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00698}00698\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Build\ complete\ dataset\ for\ a\ language\ with\ disk-\/based\ batch\ accumulation.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00699}00699\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00700}00700\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00701}00701\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ language:\ Target\ language}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00702}00702\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ total\_target:\ Total\ entries\ to\ generate\ (default\ from\ config)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00703}00703\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ sources:\ List\ of\ sources\ to\ use\ (default\ from\ config)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00704}00704\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00705}00705\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00706}00706\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ LocalBackupManager\ instance\ with\ accumulated\ batch\ files}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00707}00707\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00708}00708\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ total\_target\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00709}00709\ \ \ \ \ \ \ \ \ \ \ \ \ total\_target\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00710}00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}TARGET\_DATASET\_SIZE\_PER\_LANGUAGE"{}},\ 1000}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00711}00711\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00712}00712\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00713}00713\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sources\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00714}00714\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ default\ sources\ from\ config}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00715}00715\ \ \ \ \ \ \ \ \ \ \ \ \ default\_sources\_str\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00716}00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}DEFAULT\_DATASET\_SOURCES"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00717}00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}MILU,IndicWikiBio,IndoWordNet,Bhasha-\/Wiki"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00718}00718\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00719}00719\ \ \ \ \ \ \ \ \ \ \ \ \ sources\ =\ [s.strip()\ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ default\_sources\_str.split(\textcolor{stringliteral}{"{},"{}})]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00720}00720\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00721}00721\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}="{}}\ *\ 60)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00722}00722\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}BUILDING\ DATASET\ FOR\ \{language.upper()\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00723}00723\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Target\ size:\ \{total\_target\}\ entries"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00724}00724\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Requested\ sources:\ \{sources\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00725}00725\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}="{}}\ *\ 60)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00726}00726\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00727}00727\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Calculate\ initial\ distribution\ across\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00728}00728\ \ \ \ \ \ \ \ \ source\_targets\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a8e193eef65eda5f71b5a7ec6e199fd92}{calculate\_target\_per\_source}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00729}00729\ \ \ \ \ \ \ \ \ \ \ \ \ language,\ total\_target,\ sources}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00731}00731\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initialize\ backup\ manager\ for\ disk-\/based\ accumulation}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ backup\_manager\ =\ \mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1local__backup__manager_1_1LocalBackupManager}{LocalBackupManager}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ actual\_counts\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00735}00735\ \ \ \ \ \ \ \ \ shortfall\_total\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00736}00736\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00737}00737\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Collect\ entries\ from\ all\ sources\ with\ disk-\/based\ accumulation}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00738}00738\ \ \ \ \ \ \ \ \ logger.info(\textcolor{stringliteral}{"{}📝\ Building\ dataset\ -\/\ processing\ batches\ to\ disk\ from\ all\ sources"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00739}00739\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00740}00740\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ source\_name,\ target\_count\ \textcolor{keywordflow}{in}\ source\_targets.items():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00741}00741\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actual\_count,\ backup\_manager\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_aa0c11755ee778e687fc67acb60db3cfa}{process\_source\_streaming}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_name,\ language,\ target\_count,\ backup\_manager=backup\_manager}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00745}00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actual\_counts[source\_name]\ =\ actual\_count}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00746}00746\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00747}00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shortfall\ =\ target\_count\ -\/\ actual\_count}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00748}00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ shortfall\ >\ 0:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00749}00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shortfall\_total\ +=\ shortfall}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00750}00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00751}00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{source\_name\}\ shortfall:\ \{shortfall\}\ entries\ (got\ \{actual\_count\}/\{target\_count\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00753}00753\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00754}00754\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00755}00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.error(f\textcolor{stringliteral}{"{}Error\ processing\ \{source\_name\}:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00756}00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actual\_counts[source\_name]\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00757}00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shortfall\_total\ +=\ target\_count}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00758}00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00759}00759\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00760}00760\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ current\ total\ from\ backup\ manager\ for\ redistribution\ check}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00761}00761\ \ \ \ \ \ \ \ \ current\_total\ =\ sum(actual\_counts.values())}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00762}00762\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00763}00763\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Implement\ fallback\ mechanism\ for\ shortfall\ redistribution}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00764}00764\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ shortfall\_total\ >\ 0\ \textcolor{keywordflow}{and}\ current\_total\ <\ total\_target:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00765}00765\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}FALLBACK\ MECHANISM:\ Need\ \{shortfall\_total\}\ more\ entries"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00766}00766\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a74da1cbb4d447889962cda6ab887003d}{\_redistribute\_shortfall\_disk\_based}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00767}00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ language,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00768}00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sources,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00769}00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actual\_counts,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00770}00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_targets,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00771}00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shortfall\_total,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00772}00772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backup\_manager,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00773}00773\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00774}00774\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00775}00775\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clean\ up\ shared\ context\ scorers\ to\ free\ memory}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00776}00776\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ad919354d3558340395dbbb1143a420f0}{\_cleanup\_shared\_scorers}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00777}00777\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00778}00778\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Final\ statistics\ from\ backup\ manager}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00779}00779\ \ \ \ \ \ \ \ \ final\_stats\ =\ backup\_manager.get\_backup\_stats(language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00780}00780\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Dataset\ building\ complete\ for\ \{language\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00781}00781\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00782}00782\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Final\ size:\ \{final\_stats['total\_entries']\}\ entries\ saved\ to\ disk\ in\ \{final\_stats['batch\_count']\}\ batch\ files"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00783}00783\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00784}00784\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00785}00785\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ backup\_manager}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00786}00786\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00787}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a74da1cbb4d447889962cda6ab887003d}{00787}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a74da1cbb4d447889962cda6ab887003d}{\_redistribute\_shortfall\_disk\_based}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00788}00788\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00789}00789\ \ \ \ \ \ \ \ \ language:\ str,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00790}00790\ \ \ \ \ \ \ \ \ sources:\ List[str],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00791}00791\ \ \ \ \ \ \ \ \ actual\_counts:\ Dict[str,\ int],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00792}00792\ \ \ \ \ \ \ \ \ original\_targets:\ Dict[str,\ int],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00793}00793\ \ \ \ \ \ \ \ \ shortfall\_total:\ int,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00794}00794\ \ \ \ \ \ \ \ \ backup\_manager:\ LocalBackupManager,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00795}00795\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00796}00796\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00797}00797\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Redistribute\ shortfall\ entries\ to\ sources\ using\ disk-\/based\ backup\ manager.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00798}00798\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00799}00799\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ sources\ can't\ meet\ their\ targets,\ redistribute\ the\ missing\ entries}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00800}00800\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ other\ sources\ that\ have\ capacity\ for\ additional\ processing.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00801}00801\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00802}00802\ \ \ \ \ \ \ \ \ available\_sources\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9a16b02d16167ec2161067e672805750}{get\_available\_sources\_for\_language}}(language)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00803}00803\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ available\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00804}00804\ \ \ \ \ \ \ \ \ \ \ \ \ available\_sources\ =\ sources\ \ \textcolor{comment}{\#\ Fallback\ to\ requested\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00805}00805\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00806}00806\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ sources\ that\ met\ their\ targets\ (have\ capacity\ for\ more)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00807}00807\ \ \ \ \ \ \ \ \ successful\_sources\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00808}00808\ \ \ \ \ \ \ \ \ \ \ \ \ source}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00809}00809\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ source\ \textcolor{keywordflow}{in}\ available\_sources}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00810}00810\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ actual\_counts.get(source,\ 0)\ >=\ original\_targets.get(source,\ 0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00811}00811\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00812}00812\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00813}00813\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ no\ fully\ successful\ sources,\ try\ sources\ that\ haven't\ been\ processed\ yet}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00814}00814\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ successful\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00815}00815\ \ \ \ \ \ \ \ \ \ \ \ \ unprocessed\_sources\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00816}00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\ \textcolor{keywordflow}{for}\ source\ \textcolor{keywordflow}{in}\ sources\ \textcolor{keywordflow}{if}\ actual\_counts.get(source,\ 0)\ ==\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00817}00817\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00818}00818\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ unprocessed\_sources:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00819}00819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00820}00820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}No\ fully\ successful\ sources,\ trying\ unprocessed\ sources:\ \{unprocessed\_sources\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00821}00821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00822}00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ successful\_sources\ =\ unprocessed\_sources}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00823}00823\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00824}00824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00825}00825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}No\ sources\ available\ for\ redistribution\ (excluding\ Bhasha-\/Wiki)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00826}00826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00827}00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00828}00828\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00829}00829\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00830}00830\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Redistributing\ \{shortfall\_total\}\ entries\ among:\ \{successful\_sources\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00831}00831\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00832}00832\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00833}00833\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Distribute\ shortfall\ equally\ among\ successful\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00834}00834\ \ \ \ \ \ \ \ \ per\_source\_extra\ =\ max(1,\ shortfall\_total\ //\ len(successful\_sources))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00835}00835\ \ \ \ \ \ \ \ \ remainder\ =\ shortfall\_total\ \%\ len(successful\_sources)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00836}00836\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00837}00837\ \ \ \ \ \ \ \ \ redistributed\_count\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00838}00838\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ source\_name\ \textcolor{keywordflow}{in}\ enumerate(successful\_sources):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00839}00839\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Add\ remainder\ to\ first\ few\ sources}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00840}00840\ \ \ \ \ \ \ \ \ \ \ \ \ extra\_entries\ =\ per\_source\_extra\ +\ (1\ \textcolor{keywordflow}{if}\ i\ <\ remainder\ \textcolor{keywordflow}{else}\ 0)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00841}00841\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00842}00842\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ redistributed\_count\ >=\ shortfall\_total:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00843}00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00844}00844\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00845}00845\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00846}00846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Requesting\ \{extra\_entries\}\ additional\ entries\ from\ \{source\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00847}00847\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00848}00848\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00849}00849\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00850}00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Process\ additional\ entries\ from\ this\ source\ with\ offset}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00851}00851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ original\_target\ =\ original\_targets[source\_name]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00852}00852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ab9508ba923e1f2a6d444fefeb4b77688}{calculate\_source\_batch\_size}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00853}00853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_name,\ original\_target}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00854}00854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00855}00855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ existing\_count\ =\ actual\_counts[source\_name]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00856}00856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ estimated\_batches\_processed\ =\ (existing\_count\ //\ batch\_size)\ +\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00857}00857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1\ \textcolor{keywordflow}{if}\ existing\_count\ \%\ batch\_size\ >\ 0\ \textcolor{keywordflow}{else}\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00858}00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00859}00859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ start\_offset\ =\ estimated\_batches\_processed\ *\ batch\_size}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00860}00860\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00861}00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ additional\_count,\ backup\_manager\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_aa0c11755ee778e687fc67acb60db3cfa}{process\_source\_streaming}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00862}00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_name,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00863}00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ language,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00864}00864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extra\_entries,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00865}00865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ start\_offset=start\_offset,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00866}00866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backup\_manager=backup\_manager,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00867}00867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00868}00868\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00869}00869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ redistributed\_count\ +=\ additional\_count}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00870}00870\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00871}00871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00872}00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Got\ \{additional\_count\}\ additional\ entries\ from\ \{source\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00873}00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00874}00874\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00875}00875\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00876}00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.error(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00877}00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Failed\ to\ get\ additional\ entries\ from\ \{source\_name\}:\ \{e\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00878}00878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00879}00879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00880}00880\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00881}00881\ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00882}00882\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Redistribution\ complete:\ \{redistributed\_count\}/\{shortfall\_total\}\ additional\ entries"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00883}00883\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00884}00884\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00885}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9cac924cede7827431cc9717776371d2}{00885}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9cac924cede7827431cc9717776371d2}{\_scan\_repository\_configurations}}(self,\ repo\_id:\ str)\ -\/>\ List[str]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00886}00886\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Scan\ HuggingFace\ repository\ to\ find\ all\ existing\ language\ configurations."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00887}00887\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00888}00888\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ First\ try\ the\ proper\ HuggingFace\ API\ for\ getting\ dataset\ configurations}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00889}00889\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ datasets\ \textcolor{keyword}{import}\ get\_dataset\_config\_names}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00890}00890\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00891}00891\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Getting\ dataset\ configurations\ using\ HF\ API\ for\ \{repo\_id\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00892}00892\ \ \ \ \ \ \ \ \ \ \ \ \ configs\ =\ get\_dataset\_config\_names(repo\_id,\ token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00893}00893\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00894}00894\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Filter\ out\ any\ invalid\ configurations\ that\ might\ cause\ issues}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00895}00895\ \ \ \ \ \ \ \ \ \ \ \ \ valid\_configs\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00896}00896\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ config\ \textcolor{keywordflow}{in}\ configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00897}00897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Skip\ invalid\ configuration\ names\ (including\ "{}default"{}\ which\ causes\ issues)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00898}00898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invalid\_configs\ =\ [\textcolor{stringliteral}{"{}data"{}},\ \textcolor{stringliteral}{"{}train"{}},\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}validation"{}},\ \textcolor{stringliteral}{"{}default"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00899}00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ invalid\_configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00900}00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Additional\ validation:\ config\ names\ should\ be\ language-\/like\ (alphabetic,\ 3+\ chars)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00901}00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config.isalpha()\ \textcolor{keywordflow}{and}\ len(config)\ >=\ 3:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00902}00902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ valid\_configs.append(config)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00903}00903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00904}00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00905}00905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Skipping\ non-\/language\ configuration\ name:\ \{config\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00906}00906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00907}00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00908}00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Skipping\ invalid\ configuration\ name:\ \{config\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00909}00909\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00910}00910\ \ \ \ \ \ \ \ \ \ \ \ \ config\_list\ =\ sorted(valid\_configs)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00911}00911\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00912}00912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Found\ \{len(config\_list)\}\ valid\ configurations\ in\ \{repo\_id\}:\ \{config\_list\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00913}00913\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00914}00914\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ config\_list}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00915}00915\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00916}00916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00917}00917\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Could\ not\ get\ configurations\ using\ HF\ API:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00918}00918\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00919}00919\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Fallback\ to\ file-\/based\ scanning\ with\ improved\ logic}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00920}00920\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00921}00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ huggingface\_hub\ \textcolor{keyword}{import}\ HfApi}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00922}00922\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00923}00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ api\ =\ HfApi(token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00924}00924\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00925}00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clear\ any\ cached\ dataset\ information\ first}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00926}00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae30fb785e6dd623e541a6a0fcef74e73}{\_clear\_dataset\_cache}}(repo\_id)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00927}00927\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00928}00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ all\ files\ in\ the\ repository}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00929}00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ files\ =\ list(api.list\_repo\_files(repo\_id,\ repo\_type=\textcolor{stringliteral}{"{}dataset"{}}))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00930}00930\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00931}00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Extract\ configuration\ names\ from\ parquet\ file\ paths\ with\ better\ filtering}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00932}00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ configs\ =\ set()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00933}00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ file\ \textcolor{keywordflow}{in}\ files:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00934}00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ file.endswith(\textcolor{stringliteral}{"{}.parquet"{}})\ \textcolor{keywordflow}{and}\ \textcolor{stringliteral}{"{}/"{}}\ \textcolor{keywordflow}{in}\ file:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00935}00935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config\_name\ =\ file.split(\textcolor{stringliteral}{"{}/"{}})[0]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00936}00936\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00937}00937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Skip\ common\ false-\/positive\ directory\ names\ (including\ "{}default"{}\ which\ causes\ issues)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00938}00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invalid\_configs\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00939}00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}data"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00940}00940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.huggingface"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00941}00941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}refs"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00942}00942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}train"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00943}00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}test"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00944}00944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}validation"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00945}00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}default"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00946}00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00947}00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ invalid\_configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00948}00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Additional\ validation:\ config\ names\ should\ be\ language-\/like}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00949}00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name.isalpha()\ \textcolor{keywordflow}{and}\ len(config\_name)\ >=\ 3:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00950}00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ configs.add(config\_name)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00951}00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00952}00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00953}00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Skipping\ non-\/language\ configuration\ name\ in\ fallback:\ \{config\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00954}00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00955}00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00956}00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00957}00957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Skipping\ invalid\ configuration\ name\ in\ fallback:\ \{config\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00958}00958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00959}00959\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00960}00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config\_list\ =\ sorted(list(configs))}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00961}00961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00962}00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Found\ \{len(config\_list)\}\ configurations\ via\ fallback\ method\ in\ \{repo\_id\}:\ \{config\_list\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00963}00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00964}00964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ config\_list}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00965}00965\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00966}00966\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ fallback\_e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00967}00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Fallback\ configuration\ scan\ also\ failed:\ \{fallback\_e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00968}00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00969}00969\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00970}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae30fb785e6dd623e541a6a0fcef74e73}{00970}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae30fb785e6dd623e541a6a0fcef74e73}{\_clear\_dataset\_cache}}(self,\ repo\_id:\ str,\ config\_name:\ str\ =\ \textcolor{keywordtype}{None}):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00971}00971\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00972}00972\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Clear\ HuggingFace\ dataset\ cache\ for\ a\ specific\ repository.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00973}00973\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00974}00974\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00975}00975\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ repo\_id:\ Repository\ ID\ (e.g.,\ 'selim-\/b-\/kh/buddhi-\/pragati')}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00976}00976\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ config\_name:\ Optional\ language\ configuration\ to\ clear\ specifically.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00977}00977\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ None,\ clears\ entire\ repository\ cache.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00978}00978\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00979}00979\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00980}00980\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{import}\ shutil}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00981}00981\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ pathlib\ \textcolor{keyword}{import}\ Path}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00982}00982\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00983}00983\ \ \ \ \ \ \ \ \ \ \ \ \ repo\_name\ =\ repo\_id.replace(\textcolor{stringliteral}{"{}/"{}},\ \textcolor{stringliteral}{"{}\_\_\_"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00984}00984\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00985}00985\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00986}00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00987}00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Clearing\ HuggingFace\ cache\ for\ \{repo\_id\},\ config:\ \{config\_name\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00988}00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00989}00989\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00990}00990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Clearing\ all\ HuggingFace\ cache\ for\ repository:\ \{repo\_id\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00991}00991\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00992}00992\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clear\ HuggingFace\ datasets\ cache}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00993}00993\ \ \ \ \ \ \ \ \ \ \ \ \ cache\_dir\ =\ Path.home()\ /\ \textcolor{stringliteral}{"{}.cache"{}}\ /\ \textcolor{stringliteral}{"{}huggingface"{}}\ /\ \textcolor{stringliteral}{"{}datasets"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00994}00994\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cache\_dir.exists():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00995}00995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00996}00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Language-\/specific\ cache\ patterns}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00997}00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ patterns\_to\_clear\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00998}00998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}*\{repo\_name\}*\{config\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l00999}00999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}*\{repo\_id.replace('/',\ '\_')\}*\{config\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01000}01000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{repo\_id.split('/')[-\/1]\}*\{config\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01001}01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01002}01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01003}01003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Original\ behavior\ -\/\ clear\ all}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01004}01004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ patterns\_to\_clear\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01005}01005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}*\{repo\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01006}01006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}*\{repo\_id.replace('/',\ '\_')\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01007}01007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{repo\_id.split('/')[-\/1]\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01008}01008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01009}01009\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01010}01010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01011}01011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ pattern\ \textcolor{keywordflow}{in}\ patterns\_to\_clear:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01012}01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ cache\_path\ \textcolor{keywordflow}{in}\ cache\_dir.glob(pattern):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01013}01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cache\_path.is\_dir():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01014}01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Clearing\ dataset\ cache:\ \{cache\_path\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01015}01015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shutil.rmtree(cache\_path,\ ignore\_errors=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01016}01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01017}01017\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01018}01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cleared\_count\ >\ 0:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01019}01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Cleared\ \{cleared\_count\}\ dataset\ cache\ directories"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01020}01020\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01021}01021\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clear\ hub\ cache}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01022}01022\ \ \ \ \ \ \ \ \ \ \ \ \ hub\_cache\_dir\ =\ Path.home()\ /\ \textcolor{stringliteral}{"{}.cache"{}}\ /\ \textcolor{stringliteral}{"{}huggingface"{}}\ /\ \textcolor{stringliteral}{"{}hub"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01023}01023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hub\_cache\_dir.exists():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01024}01024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01025}01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Language-\/specific\ hub\ cache\ patterns}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01026}01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hub\_patterns\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01027}01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}datasets-\/-\/\{repo\_name\}*\{config\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01028}01028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}datasets-\/-\/\{repo\_id.replace('/',\ '-\/-\/')\}*\{config\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01029}01029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01030}01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01031}01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Original\ behavior\ -\/\ clear\ all}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01032}01032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hub\_patterns\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01033}01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}datasets-\/-\/\{repo\_name\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01034}01034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}datasets-\/-\/\{repo\_id.replace('/',\ '-\/-\/')\}*"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01035}01035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01036}01036\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01037}01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01038}01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ pattern\ \textcolor{keywordflow}{in}\ hub\_patterns:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01039}01039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ cache\_path\ \textcolor{keywordflow}{in}\ hub\_cache\_dir.glob(pattern):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01040}01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cache\_path.is\_dir():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01041}01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Clearing\ hub\ cache:\ \{cache\_path\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01042}01042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shutil.rmtree(cache\_path,\ ignore\_errors=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01043}01043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01044}01044\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01045}01045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cleared\_count\ >\ 0:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01046}01046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Cleared\ \{cleared\_count\}\ hub\ cache\ directories"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01047}01047\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01048}01048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Force\ clear\ datasets\ library\ internal\ cache}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01049}01049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01050}01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ datasets\ \textcolor{keyword}{import}\ config\ \textcolor{keyword}{as}\ datasets\_config}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01051}01051\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01052}01052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(datasets\_config,\ \textcolor{stringliteral}{"{}HF\_DATASETS\_CACHE"{}}):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01053}01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ datasets\_cache\_dir\ =\ Path(datasets\_config.HF\_DATASETS\_CACHE)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01054}01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ datasets\_cache\_dir.exists():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01055}01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\_name:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01056}01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pattern\ =\ f\textcolor{stringliteral}{"{}*\{repo\_name\}*\{config\_name\}*"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01057}01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01058}01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pattern\ =\ f\textcolor{stringliteral}{"{}*\{repo\_name\}*"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01059}01059\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01060}01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01061}01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ cache\_path\ \textcolor{keywordflow}{in}\ datasets\_cache\_dir.glob(pattern):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01062}01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cache\_path.is\_dir():}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01063}01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01064}01064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Clearing\ datasets\ internal\ cache:\ \{cache\_path\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01065}01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01066}01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shutil.rmtree(cache\_path,\ ignore\_errors=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01067}01067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cleared\_count\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01068}01068\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01069}01069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cleared\_count\ >\ 0:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01070}01070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01071}01071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Cleared\ \{cleared\_count\}\ internal\ cache\ directories"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01072}01072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01073}01073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01074}01074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01075}01075\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01076}01076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01077}01077\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01078}01078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Failed\ to\ clear\ cache\ for\ \{repo\_id\}\{f'\ (config:\ \{config\_name\})'\ if\ config\_name\ else\ ''\}:\ \{e\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01079}01079\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01080}01080\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01081}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a16c9642ce90a83bc4af836fe79bed247}{01081}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a16c9642ce90a83bc4af836fe79bed247}{\_get\_configuration\_stats}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01082}01082\ \ \ \ \ \ \ \ \ self,\ repo\_id:\ str,\ config\_name:\ str,\ force\_refresh:\ bool\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01083}01083\ \ \ \ \ )\ -\/>\ dict:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01084}01084\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01085}01085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Get\ statistics\ for\ a\ specific\ language\ configuration.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01086}01086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01087}01087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01088}01088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ repo\_id:\ Repository\ ID\ (e.g.,\ 'selim-\/b-\/kh/buddhi-\/pragati')}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01089}01089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ config\_name:\ Language\ configuration\ name\ (e.g.,\ 'english',\ 'hindi')}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01090}01090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ force\_refresh:\ If\ True,\ force\ download\ fresh\ data.\ If\ False,\ reuse\ cache\ when\ possible.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01091}01091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01092}01092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01093}01093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Validate\ configuration\ name\ before\ attempting\ to\ load}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01094}01094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ config\_name\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ config\_name.isalpha()\ \textcolor{keywordflow}{or}\ len(config\_name)\ <\ 3:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01095}01095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Invalid\ configuration\ name\ format:\ \{config\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01096}01096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(f\textcolor{stringliteral}{"{}Invalid\ configuration\ name:\ \{config\_name\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01097}01097\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01098}01098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Use\ intelligent\ download\ mode\ based\ on\ force\_refresh\ parameter}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01099}01099\ \ \ \ \ \ \ \ \ \ \ \ \ download\_mode\ =\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01100}01100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}force\_redownload"{}}\ \textcolor{keywordflow}{if}\ force\_refresh\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}reuse\_cache\_if\_exists"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01101}01101\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01102}01102\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01103}01103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ force\_refresh:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01104}01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01105}01105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Force\ refreshing\ stats\ for\ \{config\_name\}\ (fresh\ download)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01106}01106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01107}01107\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01108}01108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01109}01109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Getting\ stats\ for\ \{config\_name\}\ (reuse\ cache\ if\ available)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01110}01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01111}01111\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01112}01112\ \ \ \ \ \ \ \ \ \ \ \ \ dataset\ =\ load\_dataset(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01113}01113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01114}01114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config\_name,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01115}01115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ split=\textcolor{stringliteral}{"{}train"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01116}01116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01117}01117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ download\_mode=download\_mode,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01118}01118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verification\_mode=\textcolor{stringliteral}{"{}no\_checks"{}},\ \ \textcolor{comment}{\#\ Skip\ verification\ for\ performance}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01119}01119\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01120}01120\ \ \ \ \ \ \ \ \ \ \ \ \ df\ =\ dataset.to\_pandas()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01121}01121\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01122}01122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Validate\ required\ columns\ exist}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01123}01123\ \ \ \ \ \ \ \ \ \ \ \ \ required\_columns\ =\ [\textcolor{stringliteral}{"{}context\_score"{}},\ \textcolor{stringliteral}{"{}quality\_score"{}},\ \textcolor{stringliteral}{"{}source"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01124}01124\ \ \ \ \ \ \ \ \ \ \ \ \ missing\_columns\ =\ [col\ \textcolor{keywordflow}{for}\ col\ \textcolor{keywordflow}{in}\ required\_columns\ \textcolor{keywordflow}{if}\ col\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ df.columns]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01125}01125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ missing\_columns:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01126}01126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01127}01127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Dataset\ \{config\_name\}\ missing\ required\ columns:\ \{missing\_columns\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01128}01128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01129}01129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(f\textcolor{stringliteral}{"{}Missing\ columns:\ \{missing\_columns\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01130}01130\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01131}01131\ \ \ \ \ \ \ \ \ \ \ \ \ stats\ =\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01132}01132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}total\_entries"{}}:\ len(df),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01133}01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}sources"{}}:\ list(set(df[\textcolor{stringliteral}{"{}source"{}}].tolist())),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01134}01134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min\_quality"{}}:\ float(df[\textcolor{stringliteral}{"{}quality\_score"{}}].min()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01135}01135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_quality"{}}:\ float(df[\textcolor{stringliteral}{"{}quality\_score"{}}].max()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01136}01136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min\_context"{}}:\ float(df[\textcolor{stringliteral}{"{}context\_score"{}}].min()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01137}01137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_context"{}}:\ float(df[\textcolor{stringliteral}{"{}context\_score"{}}].max()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01138}01138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}median\_context"{}}:\ float(df[\textcolor{stringliteral}{"{}context\_score"{}}].median()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01139}01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mean\_context"{}}:\ float(df[\textcolor{stringliteral}{"{}context\_score"{}}].mean()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01140}01140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mean\_quality"{}}:\ float(df[\textcolor{stringliteral}{"{}quality\_score"{}}].mean()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01141}01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}median\_quality"{}}:\ float(df[\textcolor{stringliteral}{"{}quality\_score"{}}].median()),}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01142}01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}num\_bytes"{}}:\ dataset.info.dataset\_size\ \textcolor{keywordflow}{if}\ dataset.info\ \textcolor{keywordflow}{else}\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01143}01143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}download\_size"{}}:\ dataset.info.download\_size\ \textcolor{keywordflow}{if}\ dataset.info\ \textcolor{keywordflow}{else}\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01144}01144\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01145}01145\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01146}01146\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01147}01147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Stats\ for\ \{config\_name\}:\ \{stats['total\_entries']\}\ entries,\ sources:\ \{stats['sources']\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01148}01148\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01149}01149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ stats}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01150}01150\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01151}01151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01152}01152\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Could\ not\ get\ stats\ for\ \{config\_name\}:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01153}01153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01154}01154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}total\_entries"{}}:\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01155}01155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}sources"{}}:\ [],}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01156}01156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min\_quality"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01157}01157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_quality"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01158}01158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min\_context"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01159}01159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_context"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01160}01160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}median\_context"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01161}01161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mean\_context"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01162}01162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mean\_quality"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01163}01163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}median\_quality"{}}:\ 0.0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01164}01164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}num\_bytes"{}}:\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01165}01165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}download\_size"{}}:\ 0,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01166}01166\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01167}01167\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01168}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a6aae82f4dc09ddb92dfc6055c83b4c}{01168}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a6aae82f4dc09ddb92dfc6055c83b4c}{\_generate\_dynamic\_yaml\_header}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01169}01169\ \ \ \ \ \ \ \ \ self,\ repo\_id:\ str,\ all\_configs:\ List[str],\ active\_language:\ str\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01170}01170\ \ \ \ \ )\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01171}01171\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01172}01172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Generate\ accurate\ YAML\ header\ with\ real\ dataset\ statistics.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01173}01173\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01174}01174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01175}01175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ repo\_id:\ Repository\ ID}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01176}01176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ all\_configs:\ List\ of\ all\ language\ configurations}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01177}01177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ active\_language:\ Language\ currently\ being\ updated\ (gets\ fresh\ stats,\ others\ use\ cache)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01178}01178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01179}01179\ \ \ \ \ \ \ \ \ yaml\_lines\ =\ [\textcolor{stringliteral}{"{}-\/-\/-\/"{}},\ \textcolor{stringliteral}{"{}license:\ apache-\/2.0"{}},\ \textcolor{stringliteral}{"{}configs:"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01180}01180\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01181}01181\ \ \ \ \ \ \ \ \ dataset\_info\_lines\ =\ [\textcolor{stringliteral}{"{}dataset\_info:"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01182}01182\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01183}01183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ config\ \textcolor{keywordflow}{in}\ all\_configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01184}01184\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Config\ section}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01185}01185\ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_lines.append(f\textcolor{stringliteral}{"{}-\/\ config\_name:\ \{config\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01186}01186\ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_lines.append(\textcolor{stringliteral}{"{}\ \ data\_files:"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01187}01187\ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_lines.append(\textcolor{stringliteral}{"{}\ \ -\/\ split:\ train"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01188}01188\ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_lines.append(f\textcolor{stringliteral}{"{}\ \ \ \ path:\ \{config\}/train-\/*"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01189}01189\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01190}01190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Use\ intelligent\ caching\ -\/\ force\ refresh\ only\ for\ active\ language}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01191}01191\ \ \ \ \ \ \ \ \ \ \ \ \ force\_refresh\ =\ active\_language\ \textcolor{keywordflow}{and}\ config\ ==\ active\_language.lower()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01192}01192\ \ \ \ \ \ \ \ \ \ \ \ \ stats\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a16c9642ce90a83bc4af836fe79bed247}{\_get\_configuration\_stats}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01193}01193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,\ config,\ force\_refresh=force\_refresh}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01194}01194\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01195}01195\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01196}01196\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Dataset\ info\ section}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01197}01197\ \ \ \ \ \ \ \ \ \ \ \ \ dataset\_info\_lines.extend(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01198}01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01199}01199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ config\_name:\ \{config\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01200}01200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ features:"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01201}01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ id"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01202}01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ string"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01203}01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ clue"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01204}01204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ string"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01205}01205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ answer"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01206}01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ string"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01207}01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ source"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01208}01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ string"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01209}01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ source\_id"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01210}01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ string"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01211}01211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ context\_score"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01212}01212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ float64"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01213}01213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ quality\_score"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01214}01214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ dtype:\ float64"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01215}01215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ splits:"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01216}01216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ -\/\ name:\ train"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01217}01217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ \ \ \ num\_bytes:\ \{stats['num\_bytes']\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01218}01218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ \ \ \ num\_examples:\ \{stats['total\_entries']\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01219}01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ \ download\_size:\ \{stats['download\_size']\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01220}01220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ \ dataset\_size:\ \{stats['num\_bytes']\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01221}01221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01222}01222\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01223}01223\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01224}01224\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Combine\ all\ sections}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01225}01225\ \ \ \ \ \ \ \ \ yaml\_lines.extend(dataset\_info\_lines)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01226}01226\ \ \ \ \ \ \ \ \ yaml\_lines.append(\textcolor{stringliteral}{"{}-\/-\/-\/"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01227}01227\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01228}01228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}.join(yaml\_lines)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01229}01229\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01230}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a732274f8941ecb482c1444ec0bbd45b6}{01230}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a732274f8941ecb482c1444ec0bbd45b6}{\_generate\_clean\_yaml\_header}}(self)\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01231}01231\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Generate\ YAML\ header\ for\ clean\ repository\ (no\ configurations)."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01232}01232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}"{}-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01233}01233\ \textcolor{stringliteral}{license:\ apache-\/2.0}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01234}01234\ \textcolor{stringliteral}{configs:\ []}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01235}01235\ \textcolor{stringliteral}{dataset\_info:\ []}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01236}01236\ \textcolor{stringliteral}{-\/-\/-\/"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01237}01237\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01238}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a0950020a15d9aeb5c1959c7b47b996a4}{01238}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a0950020a15d9aeb5c1959c7b47b996a4}{\_generate\_clean\_readme\_content}}(self)\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01239}01239\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Generate\ README\ content\ for\ clean\ repository\ (no\ configurations)."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01240}01240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}"{}\#\ Buddhi-\/Pragati\ Crossword\ Dataset}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01241}01241\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01242}01242\ \textcolor{stringliteral}{This\ dataset\ will\ contain\ crossword\ clue-\/answer\ pairs\ extracted\ from\ multiple\ Indian\ language\ sources.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01243}01243\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01244}01244\ \textcolor{stringliteral}{\#\#\ Status}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01245}01245\ \textcolor{stringliteral}{Repository\ is\ currently\ clean\ and\ ready\ for\ new\ dataset\ population.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01246}01246\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01247}01247\ \textcolor{stringliteral}{\#\#\ Planned\ Features}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01248}01248\ \textcolor{stringliteral}{-\/\ Support\ for\ 20\ languages:\ Assamese,\ Bengali,\ Bodo,\ English,\ Gujarati,\ Hindi,\ Kannada,\ Kashmiri,\ Konkani,\ Malayalam,\ Marathi,\ Meitei,\ Nepali,\ Odia,\ Punjabi,\ Sanskrit,\ Tamil,\ Telugu,\ Urdu}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01249}01249\ \textcolor{stringliteral}{-\/\ Multiple\ sources:\ MILU,\ IndicWikiBio,\ IndoWordNet,\ Bhasha-\/Wiki}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01250}01250\ \textcolor{stringliteral}{-\/\ Quality\ scoring\ and\ cultural\ context\ assessment}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01251}01251\ \textcolor{stringliteral}{-\/\ 5000\ entries\ per\ language\ target}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01252}01252\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01253}01253\ \textcolor{stringliteral}{\#\#\ Dataset\ Structure}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01254}01254\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01255}01255\ \textcolor{stringliteral}{Each\ entry\ will\ contain:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01256}01256\ \textcolor{stringliteral}{-\/\ \`{}id\`{}:\ Unique\ identifier}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01257}01257\ \textcolor{stringliteral}{-\/\ \`{}clue\`{}:\ Crossword\ clue\ text}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01258}01258\ \textcolor{stringliteral}{-\/\ \`{}answer\`{}:\ Single-\/word\ answer\ (uppercase)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01259}01259\ \textcolor{stringliteral}{-\/\ \`{}source\`{}:\ Original\ data\ source\ (MILU,\ IndicWikiBio,\ IndoWordNet,\ Bhasha-\/Wiki)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01260}01260\ \textcolor{stringliteral}{-\/\ \`{}source\_id\`{}:\ Original\ ID\ in\ source\ dataset}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01261}01261\ \textcolor{stringliteral}{-\/\ \`{}context\_score\`{}:\ Indian\ cultural\ context\ score\ (0.0-\/1.0)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01262}01262\ \textcolor{stringliteral}{-\/\ \`{}quality\_score\`{}:\ Crossword\ suitability\ score\ (0.0-\/1.0)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01263}01263\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01264}01264\ \textcolor{stringliteral}{Automatically\ generated\ crossword\ benchmark\ dataset."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01265}01265\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01266}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a70e3b8e07fe0e6de7c8ba78ef5dcd595}{01266}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a70e3b8e07fe0e6de7c8ba78ef5dcd595}{\_generate\_dynamic\_readme\_content}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01267}01267\ \ \ \ \ \ \ \ \ self,\ repo\_id:\ str,\ all\_configs:\ List[str],\ active\_language:\ str\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01268}01268\ \ \ \ \ )\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01269}01269\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01270}01270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Generate\ unified\ README\ content\ with\ real\ statistics\ for\ all\ languages.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01271}01271\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01272}01272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01273}01273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ repo\_id:\ Repository\ ID}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01274}01274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ all\_configs:\ List\ of\ all\ language\ configurations}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01275}01275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ active\_language:\ Language\ currently\ being\ updated\ (gets\ fresh\ stats,\ others\ use\ cache)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01276}01276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01277}01277\ \ \ \ \ \ \ \ \ content\_lines\ =\ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01278}01278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\ Buddhi-\/Pragati\ Crossword\ Dataset"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01279}01279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01280}01280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}This\ dataset\ contains\ crossword\ clue-\/answer\ pairs\ extracted\ from\ multiple\ Indian\ language\ sources."{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01281}01281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01282}01282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\#\ Available\ Languages"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01283}01283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01284}01284\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01285}01285\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01286}01286\ \ \ \ \ \ \ \ \ total\_entries\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01287}01287\ \ \ \ \ \ \ \ \ all\_sources\ =\ set()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01288}01288\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01289}01289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ config\ \textcolor{keywordflow}{in}\ sorted(all\_configs):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01290}01290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Use\ intelligent\ caching\ -\/\ force\ refresh\ only\ for\ active\ language}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01291}01291\ \ \ \ \ \ \ \ \ \ \ \ \ force\_refresh\ =\ active\_language\ \textcolor{keywordflow}{and}\ config\ ==\ active\_language.lower()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01292}01292\ \ \ \ \ \ \ \ \ \ \ \ \ stats\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a16c9642ce90a83bc4af836fe79bed247}{\_get\_configuration\_stats}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01293}01293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,\ config,\ force\_refresh=force\_refresh}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01294}01294\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01295}01295\ \ \ \ \ \ \ \ \ \ \ \ \ total\_entries\ +=\ stats[\textcolor{stringliteral}{"{}total\_entries"{}}]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01296}01296\ \ \ \ \ \ \ \ \ \ \ \ \ all\_sources.update(stats[\textcolor{stringliteral}{"{}sources"{}}])}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01297}01297\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01298}01298\ \ \ \ \ \ \ \ \ \ \ \ \ content\_lines.extend(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01299}01299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01300}01300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\#\#\#\ \{config.title()\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01301}01301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Total\ Entries**:\ \{stats['total\_entries']\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01302}01302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Sources**:\ \{',\ '.join(stats['sources'])\}\ \(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01303}01303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Quality\ Scores:"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01304}01304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Quality\ Score\ Range**:\ \{stats['min\_quality']:.2f\}\ -\/\ \{stats['max\_quality']:.2f\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01305}01305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Average\ Quality\ Score**:\ \{stats['mean\_quality']:.3f\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01306}01306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Median\ Quality\ Score**:\ \{stats['median\_quality']:.3f\}\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01307}01307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Indian\ Cultural\ Context\ Scores:"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01308}01308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Context\ Score\ Range**:\ \{stats['min\_context']:.2f\}\ -\/\ \{stats['max\_context']:.2f\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01309}01309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Average\ Context\ Score**:\ \{stats['mean\_context']:.3f\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01310}01310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Median\ Context\ Score**:\ \{stats['median\_context']:.3f\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01311}01311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01312}01312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01313}01313\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01314}01314\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01315}01315\ \ \ \ \ \ \ \ \ content\_lines.extend(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01316}01316\ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01317}01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\#\ Dataset\ Structure"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01318}01318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01319}01319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Each\ entry\ contains:"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01320}01320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}id`:\ Unique\ identifier"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01321}01321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}clue`:\ Crossword\ clue\ text"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01322}01322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}answer`:\ Single-\/word\ answer\ (uppercase)"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01323}01323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}source`:\ Original\ data\ source\ (MILU,\ IndicWikiBio,\ IndoWordNet,\ Bhasha-\/Wiki)"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01324}01324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}source\_id`:\ Original\ ID\ in\ source\ dataset"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01325}01325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}context\_score`:\ Indian\ cultural\ context\ score\ (0.0-\/1.0)"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01326}01326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/\ \`{}quality\_score`:\ Crossword\ suitability\ score\ (0.0-\/1.0)"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01327}01327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01328}01328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\#\ Usage"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01329}01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01330}01330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\`{}\`{}\`{}python"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01331}01331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}from\ datasets\ import\ load\_dataset"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01332}01332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01333}01333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\ Load\ specific\ language"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01334}01334\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01335}01335\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01336}01336\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01337}01337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ config\ \textcolor{keywordflow}{in}\ sorted(all\_configs):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01338}01338\ \ \ \ \ \ \ \ \ \ \ \ \ content\_lines.append(f\textcolor{stringliteral}{'dataset\ =\ load\_dataset("{}\{repo\_id\}"{},\ "{}\{config\}"{})'})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01339}01339\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01340}01340\ \ \ \ \ \ \ \ \ content\_lines.extend(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01341}01341\ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01342}01342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\`{}\`{}\`{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01343}01343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01344}01344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#\#\ Summary\ Statistics"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01345}01345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01346}01346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Total\ Languages**:\ \{len(all\_configs)\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01347}01347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **Total\ Entries**:\ \{total\_entries:,\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01348}01348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}-\/\ **All\ Sources**:\ \{',\ '.join(sorted(all\_sources))\}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01349}01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01350}01350\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01351}01351\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01352}01352\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01353}01353\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}.join(content\_lines)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01354}01354\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01355}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a20a5160b166d6474cc9a2081c46a29}{01355}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a20a5160b166d6474cc9a2081c46a29}{\_update\_dataset\_card\_incremental}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01356}01356\ \ \ \ \ \ \ \ \ self,\ language:\ str,\ repo\_id:\ str,\ force\_full\_stats:\ bool\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01357}01357\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01358}01358\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01359}01359\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Update\ dataset\ README.md\ with\ current\ real\ statistics\ after\ incremental\ upload.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01360}01360\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01361}01361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01362}01362\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ language:\ Language\ that\ was\ just\ uploaded}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01363}01363\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ repo\_id:\ Repository\ ID}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01364}01364\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ force\_full\_stats:\ If\ True,\ collect\ fresh\ statistics\ for\ all\ languages.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01365}01365\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ False,\ only\ refresh\ stats\ for\ the\ uploaded\ language.}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01366}01366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01367}01367\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01368}01368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ force\_full\_stats:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01369}01369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01370}01370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Updating\ dataset\ card\ for\ \{repo\_id\}\ with\ full\ statistics\ refresh"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01371}01371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01372}01372\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01373}01373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01374}01374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Updating\ dataset\ card\ for\ \{repo\_id\}\ after\ \{language\}\ upload\ (intelligent\ caching)"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01375}01375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01376}01376\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01377}01377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scan\ all\ configurations\ in\ repository}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01378}01378\ \ \ \ \ \ \ \ \ \ \ \ \ all\_configs\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a9cac924cede7827431cc9717776371d2}{\_scan\_repository\_configurations}}(repo\_id)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01379}01379\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01380}01380\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ all\_configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01381}01381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01382}01382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}No\ configurations\ found\ in\ repository,\ updating\ README\ to\ show\ clean\ state"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01383}01383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01384}01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ clean\ repository\ README}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01385}01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_header\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a732274f8941ecb482c1444ec0bbd45b6}{\_generate\_clean\_yaml\_header}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01386}01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ readme\_content\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a0950020a15d9aeb5c1959c7b47b996a4}{\_generate\_clean\_readme\_content}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01387}01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ full\_readme\ =\ yaml\_header\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ readme\_content}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01388}01388\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01389}01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Determine\ active\ language\ for\ intelligent\ caching}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01390}01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ active\_language\ =\ language\ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ force\_full\_stats\ \textcolor{keywordflow}{else}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01391}01391\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01392}01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ dynamic\ YAML\ header\ with\ intelligent\ caching}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01393}01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yaml\_header\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a6aae82f4dc09ddb92dfc6055c83b4c}{\_generate\_dynamic\_yaml\_header}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01394}01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,\ all\_configs,\ active\_language=active\_language}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01395}01395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01396}01396\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01397}01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ unified\ README\ content\ with\ intelligent\ caching}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01398}01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ readme\_content\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a70e3b8e07fe0e6de7c8ba78ef5dcd595}{\_generate\_dynamic\_readme\_content}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01399}01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,\ all\_configs,\ active\_language=active\_language}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01400}01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01401}01401\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01402}01402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Combine\ YAML\ header\ and\ content}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01403}01403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ full\_readme\ =\ yaml\_header\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ readme\_content}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01404}01404\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01405}01405\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ dataset\ card}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01406}01406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ huggingface\_hub\ \textcolor{keyword}{import}\ DatasetCard}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01407}01407\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01408}01408\ \ \ \ \ \ \ \ \ \ \ \ \ card\ =\ DatasetCard(full\_readme)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01409}01409\ \ \ \ \ \ \ \ \ \ \ \ \ card.push\_to\_hub(repo\_id,\ token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01410}01410\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01411}01411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ all\_configs:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01412}01412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats\_type\ =\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01413}01413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}full\ statistics"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01414}01414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ force\_full\_stats}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01415}01415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ f\textcolor{stringliteral}{"{}intelligent\ caching\ (refreshed\ \{language\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01416}01416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01417}01417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01418}01418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}✅\ Updated\ dataset\ card\ for\ \{repo\_id\}\ with\ \{len(all\_configs)\}\ language\ configurations\ (\{stats\_type\})"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01419}01419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01420}01420\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01421}01421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01422}01422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}✅\ Updated\ dataset\ card\ for\ \{repo\_id\}\ to\ show\ clean\ repository\ state"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01423}01423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01424}01424\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01425}01425\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01426}01426\ \ \ \ \ \ \ \ \ \ \ \ \ logger.error(f\textcolor{stringliteral}{"{}Failed\ to\ update\ dataset\ card:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01427}01427\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ raise\ -\/\ this\ shouldn't\ block\ the\ upload\ process}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01428}01428\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01429}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a17606662d79f3c958b3dcf6a77a13d8c}{01429}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a17606662d79f3c958b3dcf6a77a13d8c}{\_validate\_dataset\_entries}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01430}01430\ \ \ \ \ \ \ \ \ self,\ entries:\ List[DatasetEntry]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01431}01431\ \ \ \ \ )\ -\/>\ List[DatasetEntry]:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01432}01432\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Validate\ DatasetEntry\ types\ and\ values\ before\ upload\ to\ prevent\ type\ conversion\ errors."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01433}01433\ \ \ \ \ \ \ \ \ valid\_entries\ =\ []}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01434}01434\ \ \ \ \ \ \ \ \ validation\_errors\ =\ 0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01435}01435\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01436}01436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ entry\ \textcolor{keywordflow}{in}\ enumerate(entries):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01437}01437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01438}01438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Validate\ and\ ensure\ correct\ types}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01439}01439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entry\ =\ \mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1data__structure_1_1DatasetEntry}{DatasetEntry}}(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01440}01440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ id=str(entry.id),\ \ \textcolor{comment}{\#\ Ensure\ string}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01441}01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ clue=str(entry.clue),\ \ \textcolor{comment}{\#\ Ensure\ string}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01442}01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer=str(entry.answer),\ \ \textcolor{comment}{\#\ Ensure\ string}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01443}01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source=str(entry.source),\ \ \textcolor{comment}{\#\ Ensure\ string}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01444}01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_id=str(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01445}01445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entry.source\_id}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01446}01446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ),\ \ \textcolor{comment}{\#\ Ensure\ string\ (fixes\ type\ conversion\ issues)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01447}01447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context\_score=float(entry.context\_score),\ \ \textcolor{comment}{\#\ Ensure\ float}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01448}01448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ quality\_score=float(entry.quality\_score),\ \ \textcolor{comment}{\#\ Ensure\ float}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01449}01449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01450}01450\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01451}01451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Additional\ validation\ checks}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01452}01452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01453}01453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ validated\_entry.id}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01454}01454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ validated\_entry.clue}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01455}01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ validated\_entry.answer}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01456}01456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01457}01457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Entry\ \{i\}\ has\ empty\ required\ fields,\ skipping"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01458}01458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validation\_errors\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01459}01459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01460}01460\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01461}01461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01462}01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entry.context\_score\ <\ 0.0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01463}01463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ validated\_entry.context\_score\ >\ 1.0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01464}01464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01465}01465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01466}01466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Entry\ \{i\}\ has\ invalid\ context\_score:\ \{validated\_entry.context\_score\},\ clamping\ to\ [0,1]"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01467}01467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01468}01468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entry.context\_score\ =\ max(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01469}01469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0,\ min(1.0,\ validated\_entry.context\_score)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01470}01470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01471}01471\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01472}01472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01473}01473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entry.quality\_score\ <\ 0.0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01474}01474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ validated\_entry.quality\_score\ >\ 1.0}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01475}01475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01476}01476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01477}01477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Entry\ \{i\}\ has\ invalid\ quality\_score:\ \{validated\_entry.quality\_score\},\ clamping\ to\ [0,1]"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01478}01478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01479}01479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entry.quality\_score\ =\ max(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01480}01480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0,\ min(1.0,\ validated\_entry.quality\_score)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01481}01481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01482}01482\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01483}01483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ valid\_entries.append(validated\_entry)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01484}01484\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01485}01485\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ (ValueError,\ TypeError)\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01486}01486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Entry\ \{i\}\ validation\ failed:\ \{e\},\ skipping"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01487}01487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validation\_errors\ +=\ 1}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01488}01488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01489}01489\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01490}01490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ validation\_errors\ >\ 0:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01491}01491\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01492}01492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Validation\ complete:\ \{len(valid\_entries)\}/\{len(entries)\}\ entries\ valid,\ \{validation\_errors\}\ entries\ rejected"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01493}01493\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01494}01494\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01495}01495\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(f\textcolor{stringliteral}{"{}Validation\ complete:\ all\ \{len(entries)\}\ entries\ valid"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01496}01496\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01497}01497\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ valid\_entries}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01498}01498\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01499}\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_acf12626056f96048609a3497143f7522}{01499}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_acf12626056f96048609a3497143f7522}{upload\_to\_huggingface}}(self,\ entries:\ List[DatasetEntry],\ language:\ str):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01500}01500\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Upload\ processed\ entries\ to\ HuggingFace\ dataset."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01501}01501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a6b163206709d70cc38b1debc6c882d1d}{hf\_api}}\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01502}01502\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}No\ HuggingFace\ token\ provided,\ skipping\ upload"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01503}01503\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01504}01504\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01505}01505\ \ \ \ \ \ \ \ \ repo\_id\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7587ff77e5846c065c9f4738ede43d3b}{dataset\_config}}.get(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01506}01506\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}HF\_DATASET\_REPO"{}},\ \textcolor{stringliteral}{"{}selim-\/b-\/kh/Buddhi\_pragati"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01507}01507\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01508}01508\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01509}01509\ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Uploading\ \{len(entries)\}\ entries\ to\ \{repo\_id\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01510}01510\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01511}01511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01512}01512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Validate\ entries\ before\ upload\ to\ prevent\ type\ conversion\ errors}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01513}01513\ \ \ \ \ \ \ \ \ \ \ \ \ validated\_entries\ =\ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a17606662d79f3c958b3dcf6a77a13d8c}{\_validate\_dataset\_entries}}(entries)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01514}01514\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ validated\_entries:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01515}01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01516}01516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}No\ valid\ entries\ after\ validation\ for\ \{language\},\ skipping\ upload"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01517}01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01518}01518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01519}01519\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01520}01520\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(validated\_entries)\ !=\ len(entries):}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01521}01521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01522}01522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Validation\ filtered\ \{len(entries)\ -\/\ len(validated\_entries)\}\ entries\ for\ \{language\}"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01523}01523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01524}01524\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01525}01525\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ensure\ repository\ exists}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01526}01526\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ huggingface\_hub\ \textcolor{keyword}{import}\ create\_repo}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01527}01527\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01528}01528\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01529}01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ create\_repo(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01530}01530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01531}01531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_type=\textcolor{stringliteral}{"{}dataset"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01532}01532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01533}01533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exist\_ok=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01534}01534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ private=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01535}01535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01536}01536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Ensured\ repository\ \{repo\_id\}\ exists"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01537}01537\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ repo\_error:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01538}01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(f\textcolor{stringliteral}{"{}Repository\ creation/check\ failed:\ \{repo\_error\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01539}01539\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01540}01540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Convert\ validated\ entries\ to\ pandas\ DataFrame\ -\/\ no\ local\ merging\ needed}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01541}01541\ \ \ \ \ \ \ \ \ \ \ \ \ new\_data\_dicts\ =\ [asdict(entry)\ \textcolor{keywordflow}{for}\ entry\ \textcolor{keywordflow}{in}\ validated\_entries]}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01542}01542\ \ \ \ \ \ \ \ \ \ \ \ \ new\_df\ =\ pd.DataFrame(new\_data\_dicts)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01543}01543\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01544}01544\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ HF\ Dataset\ from\ new\ entries\ only}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01545}01545\ \ \ \ \ \ \ \ \ \ \ \ \ final\_dataset\ =\ Dataset.from\_pandas(new\_df)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01546}01546\ \ \ \ \ \ \ \ \ \ \ \ \ config\_name\ =\ language.lower()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01547}01547\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01548}01548\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01549}01549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Uploading\ \{len(validated\_entries)\}\ entries\ as\ complete\ config\ replacement\ to\ HF"{}}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01550}01550\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01551}01551\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01552}01552\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ HuggingFace\ performs\ complete\ config\ replacement\ (not\ merging)}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01553}01553\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ replaces\ the\ entire\ language\ configuration\ with\ new\ data}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01554}01554\ \ \ \ \ \ \ \ \ \ \ \ \ final\_dataset.push\_to\_hub(}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01555}01555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ repo\_id,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01556}01556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config\_name=config\_name,}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01557}01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ split=\textcolor{stringliteral}{"{}train"{}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01558}01558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ token=self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae7c24d2d5cedc90bff85f9e8c4b978ee}{hf\_token}},}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01559}01559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ completely\ replaces\ the\ config,\ no\ merging\ occurs}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01560}01560\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01561}01561\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01562}01562\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Clear\ any\ stale\ caches\ before\ updating\ metadata}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01563}01563\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_ae30fb785e6dd623e541a6a0fcef74e73}{\_clear\_dataset\_cache}}(repo\_id,\ config\_name)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01564}01564\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01565}01565\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ dataset\ card\ with\ proper\ YAML\ metadata}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01566}01566\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_a7a20a5160b166d6474cc9a2081c46a29}{\_update\_dataset\_card\_incremental}}(language,\ repo\_id)}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01567}01567\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01568}01568\ \ \ \ \ \ \ \ \ \ \ \ \ logger.info(f\textcolor{stringliteral}{"{}Successfully\ uploaded\ \{language\}\ dataset\ to\ \{repo\_id\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01569}01569\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01570}01570\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Explicit\ memory\ cleanup\ after\ upload}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01571}01571\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_af48ac3fc1427774f6c12ef2305b60d30}{\_cleanup\_after\_upload}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01572}01572\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01573}01573\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ repo\_id}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01574}01574\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01575}01575\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01576}01576\ \ \ \ \ \ \ \ \ \ \ \ \ logger.error(f\textcolor{stringliteral}{"{}Failed\ to\ upload\ to\ HuggingFace:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01577}01577\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{import}\ traceback}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01578}01578\ }
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01579}01579\ \ \ \ \ \ \ \ \ \ \ \ \ logger.error(f\textcolor{stringliteral}{"{}Upload\ error\ details:\ \{traceback.format\_exc()\}"{}})}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01580}01580\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Cleanup\ even\ on\ failure\ to\ free\ memory}}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01581}01581\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classbuddhi__pragati_1_1data_1_1dataset__builder_1_1DatasetBuilder_af48ac3fc1427774f6c12ef2305b60d30}{\_cleanup\_after\_upload}}()}
\DoxyCodeLine{\Hypertarget{dataset__builder_8py_source_l01582}01582\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}

\end{DoxyCode}
